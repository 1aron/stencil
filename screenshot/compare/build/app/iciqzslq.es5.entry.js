/*! Built with http://stenciljs.com */
var __awaiter=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(n,r){function s(e){try{d(a.next(e))}catch(e){r(e)}}function l(e){try{d(a.throw(e))}catch(e){r(e)}}function d(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(s,l)}d((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var i,a,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,a&&(n=2&r[0]?a.return:r[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,r[1])).done)return n;switch(a=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}};App.loadBundle("iciqzslq",["exports","./chunk-61fec0be.js"],function(e,t){var i=window.App.h,a=function(){function e(){this.mismatchedPixels=null,this.mismatchedRatio=null}return e.prototype.navToId=function(e){e.preventDefault(),e.stopPropagation(),t.updateHash({diff:this.diffId})},e.prototype.render=function(){return[i("p",{class:"test-path"},this.testPath),i("dl",null,i("div",null,i("dt",null,"Diff"),i("dd",null,i("a",{href:"#diff-"+this.diffId,onClick:this.navToId.bind(this)},this.diffId))),i("div",null,i("dt",null,"Mismatched Pixels"),i("dd",null,"number"==typeof this.mismatchedPixels?this.mismatchedPixels:"--")),i("div",null,i("dt",null,"Mismatched Ratio"),i("dd",null,"number"==typeof this.mismatchedRatio?this.mismatchedRatio.toFixed(4):"--")),i("div",null,i("dt",null,"Device"),i("dd",null,this.device)),i("div",null,i("dt",null,"Width"),i("dd",null,this.width)),i("div",null,i("dt",null,"Height"),i("dd",null,this.height)),i("div",null,i("dt",null,"Device Scale Factor"),i("dd",null,this.deviceScaleFactor)),i("div",{class:"desc"},i("dt",null,"Description"),i("dd",null,this.desc)))]},Object.defineProperty(e,"is",{get:function(){return"compare-analysis"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{desc:{type:String,attr:"desc"},device:{type:String,attr:"device"},deviceScaleFactor:{type:Number,attr:"device-scale-factor"},diffId:{type:String,attr:"diff-id"},height:{type:Number,attr:"height"},mismatchedPixels:{type:Number,attr:"mismatched-pixels"},mismatchedRatio:{type:Number,attr:"mismatched-ratio"},testPath:{type:String,attr:"test-path"},width:{type:Number,attr:"width"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".test-path{margin-top:0;padding-top:0;font-size:10px;color:var(--analysis-data-color)}dl{padding:0;margin:0;font-size:var(--analysis-data-font-size);line-height:28px}div{display:-webkit-box;display:-ms-flexbox;display:flex;width:240px}dt{display:inline;-webkit-box-flex:2;-ms-flex:2;flex:2;font-weight:500}dd{display:inline;-webkit-box-flex:1;-ms-flex:1;flex:1;color:var(--analysis-data-color)}.desc,.desc dt{display:block}.desc dd{display:block;margin:0}p{padding-top:14px;font-size:var(--analysis-data-font-size)}a{color:var(--analysis-data-color)}a:hover{text-decoration:none}"},enumerable:!0,configurable:!0}),e}();function n(e,t,i,a,s,l){for(var d,o,h,c,u=Math.max(t-1,0),f=Math.max(i-1,0),m=Math.min(t+1,a-1),p=Math.min(i+1,s-1),g=4*(i*a+t),v=0,y=0,b=0,w=0,x=0,P=u;P<=m;P++)for(var I=f;I<=p;I++)if(P!==t||I!==i){var A=r(e,e,g,4*(I*a+P),!0);if(0===A?v++:A<0?b++:A>0&&y++,v>2)return!1;l&&(A<w&&(w=A,d=P,o=I),A>x&&(x=A,h=P,c=I))}return!l||0!==b&&0!==y&&(!n(e,d,o,a,s)&&!n(l,d,o,a,s)||!n(e,h,c,a,s)&&!n(l,h,c,a,s))}function r(e,t,i,a,n){var r=e[i+3]/255,h=t[a+3]/255,c=o(e[i+0],r),u=o(e[i+1],r),f=o(e[i+2],r),m=o(t[a+0],h),p=o(t[a+1],h),g=o(t[a+2],h),v=s(c,u,f)-s(m,p,g);if(n)return v;var y=l(c,u,f)-l(m,p,g),b=d(c,u,f)-d(m,p,g);return.5053*v*v+.299*y*y+.1957*b*b}function s(e,t,i){return.29889531*e+.58662247*t+.11448223*i}function l(e,t,i){return.59597799*e-.2741761*t-.32180189*i}function d(e,t,i){return.21147017*e-.52261711*t+.31114694*i}function o(e,t){return 255+(e-255)*t}function h(e,t,i,a,n){e[t+0]=i,e[t+1]=a,e[t+2]=n,e[t+3]=255}function c(e,t,i){if(f.has(e))i(f.get(e));else if(u.has(e))u.get(e).push(i);else{u.set(e,[i]);var a=document.createElement("script");a.src=t,document.head.appendChild(a)}}window.loadScreenshot=function(e,t){var i=u.get(e);i&&(i.forEach(function(e){return e(t)}),u.delete(e)),f.set(e,t)};var u=new Map,f=new Map,m=function(){function e(){this.mismatchedPixels=null,this.isComparable=!1,this.imagesLoaded=new Set,this.isImageALoaded=!1,this.isImageBLoaded=!1,this.isCanvasLoaded=!1,this.initialized=!1,this.isComparing=!1,this.mismatchedRatio=null,this.hasRendered=!1}return e.prototype.componentWillLoad=function(){this.mismatchedPixels=this.diff.mismatchedPixels,this.mismatchedRatio=this.diff.mismatchedRatio,this.isComparable=null!=this.diff.imageA&&null!=this.diff.imageB,this.device=this.diff.device},e.prototype.runCompare=function(){this.diff.identical||this.initialized||(this.initialized=!0,window.requestIdleCallback?window.requestIdleCallback(this.loadImages.bind(this)):window.requestAnimationFrame(this.loadImages.bind(this)))},e.prototype.loadImages=function(){var e=this;null!=this.diff.imageA&&c(this.diff.imageA,this.diff.jsonpUrlA,function(t){e.imageA.src=t,e.imageA.style.visibility="",e.isImageALoaded=!0}),null!=this.diff.imageB&&c(this.diff.imageB,this.diff.jsonpUrlB,function(t){e.imageB.src=t,e.imageB.style.visibility="",e.isImageBLoaded=!0})},e.prototype.compareImages=function(){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(a){switch(a.label){case 0:return e=this.diff,!this.isImageALoaded||!this.isImageBLoaded||this.isComparing||this.isCanvasLoaded?[2]:(this.isComparing=!0,i=this,[4,function(e,t,i,a,l){var d=document.createElement("canvas");d.width=a,d.height=l;var c=document.createElement("canvas");c.width=a,c.height=l;var u=d.getContext("2d");u.drawImage(e,0,0);var f=c.getContext("2d");f.drawImage(t,0,0);var m=document.createElement("canvas").getContext("2d");m.drawImage(e,0,0),m.getImageData(0,0,a,l);var p=u.getImageData(0,0,a,l).data,g=f.getImageData(0,0,a,l).data,v=i.getContext("2d"),y=v.createImageData(a,d.height),b=function(e,t,i,a,l,d){d||(d={});for(var c=void 0===d.threshold?.1:d.threshold,u=35215*c*c,f=0,m=0;m<l;m++)for(var p=0;p<a;p++){var g=4*(m*a+p);if(r(e,t,g,g)>u)d.includeAA||!n(e,p,m,a,l,t)&&!n(t,p,m,a,l,e)?(i&&h(i,g,255,0,0),f++):i&&h(i,g,255,255,0);else if(i){var v=o(s(o((y=e)[(b=g)+0],w=y[b+3]/255),o(y[b+1],w),o(y[b+2],w)),.1);h(i,g,v,v,v)}}var y,b,w;return f}(p,g,y.data,a,l,{threshold:.1});return v.putImageData(y,0,0),b}(this.imageA,this.imageB,this.canvas,e.naturalWidth,e.naturalHeight)]);case 1:return i.mismatchedPixels=a.sent(),this.canvas.style.visibility="",this.isCanvasLoaded=!0,this.mismatchedRatio=e.mismatchedPixels/(e.naturalWidth*e.naturalHeight),this.analysis&&(this.analysis.mismatchedPixels=this.mismatchedPixels,this.analysis.mismatchedRatio=this.mismatchedRatio),t.setMismatchedPixels(e.imageA,e.imageB,e.mismatchedPixels),t.runFilters(),[2]}})})},e.prototype.render=function(){var e=this;if(!this.hasRendered){this.hasRendered=!0;var t=this.diff,a={width:t.width+"px",height:t.height+"px",visibility:this.diff.identical?"":"hidden"};return[i("compare-cell",null,i("img",{src:this.diff.identical?this.imagesUrl+t.imageA:"",style:a,onLoad:this.diff.identical?null:this.compareImages.bind(this),ref:function(t){return e.imageA=t}})),i("compare-cell",null,i("img",{src:this.diff.identical?this.imagesUrl+t.imageA:"",style:a,onLoad:this.diff.identical?null:this.compareImages.bind(this),ref:function(t){return e.imageB=t}})),i("compare-cell",null,this.diff.identical?i("img",{style:a,src:this.imagesUrl+t.imageA}):i("canvas",{width:t.naturalWidth,height:t.naturalHeight,style:a,ref:function(t){return e.canvas=t}})),i("compare-cell",null,i("compare-analysis",{diffId:this.diff.id,mismatchedPixels:this.mismatchedPixels,mismatchedRatio:this.mismatchedRatio,device:this.diff.device,width:this.diff.width,height:this.diff.height,deviceScaleFactor:this.diff.deviceScaleFactor,desc:this.diff.desc,testPath:this.diff.testPath,ref:function(t){return e.analysis=t}}))]}},Object.defineProperty(e,"is",{get:function(){return"compare-row"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{device:{type:String,attr:"device",mutable:!0},diff:{type:"Any",attr:"diff"},elm:{elementRef:!0},imagesUrl:{type:String,attr:"images-url"},isComparable:{type:Boolean,attr:"is-comparable",mutable:!0},mismatchedPixels:{type:Number,attr:"mismatched-pixels",mutable:!0},runCompare:{method:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"compare-row canvas,compare-row img{-webkit-box-shadow:var(--screenshot-box-shadow);box-shadow:var(--screenshot-box-shadow);border-radius:var(--screenshot-border-radius)}"},enumerable:!0,configurable:!0}),e}();e.CompareAnalysis=a,e.CompareRow=m,Object.defineProperty(e,"__esModule",{value:!0})});